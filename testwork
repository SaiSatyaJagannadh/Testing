def _analyze_error_line_local(self, error_line, line_num, filename):
    """Analyze error line using local knowledge base"""
    import datetime  # Import here to fix the error
    
    error_keywords = self._extract_keywords(error_line)
    best_match = self._find_best_solution_match(error_keywords, error_line)
    
    current_time = datetime.datetime.now().isoformat()
    
    if best_match:
        return {
            'filename': filename,
            'line_number': line_num,
            'error_line': error_line.strip(),
            'error_keywords': error_keywords,
            'matched_solution': best_match['solution'],
            'original_error': best_match['original_error'],
            'confidence': best_match['confidence'],
            'jobname_reference': best_match.get('jobname', ''),
            'analysis_method': 'local_knowledge_base',
            'analysis_time': current_time
        }
    
    return {
        'filename': filename,
        'line_number': line_num,
        'error_line': error_line.strip(),
        'error_keywords': error_keywords,
        'matched_solution': 'No local solution found. Checking with AI...',
        'confidence': 0.1,
        'analysis_method': 'local_fallback',
        'analysis_time': current_time
    }
